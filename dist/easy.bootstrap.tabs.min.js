/**
 * EasyBootstrapTabs
 * 
 * Version 1.2.1
 * 
 * http://easyproject.cn 
 * https://github.com/ushelp
 * 
 * Copyright 2012 Ray [ inthinkcolor@gmail.com ]
 * Released under the MIT license
 * 
 * Dependencies: [Bootstrap3, jquery.contextify.min.js] 
 *
 * [Bootstrap plugin, supports other bootstrap-based ui frameworks]
 * 
 */
!function(){var b,a=!0,c=[],d=function(a){var e,f,h,i,j,c=g.tabObj,d=a.attr("href");if(a.attr("href")==b){for(2==g.tabHistory.length?(f=g.tabHistory[0],e=c.find('a[href="'+f+'"]'),e.tab("show")):(h=a.parent(),h.next().length>0?(e=h.next().find("a"),e.tab("show")):(e=h.prev().find("a"),e.tab("show"))),i=[],j=0;j<g.tabHistory.length;j++)g.tabHistory[j]!=d&&i.push(g.tabHistory[j]);g.tabHistory=i,b=e.attr("href"),g.tabHistory[g.tabHistory.length-1]!=b&&g.tabHistory.push(b)}else{for(i=[],j=0;j<g.tabHistory.length;j++)g.tabHistory[j]!=d&&i.push(g.tabHistory[j]);g.tabHistory=i}$(d).remove(),a.parent().remove()},e=function(a){var c,e,f;a.find("a").off("click"),a.find("span.glyphicon-remove").off("click"),a.find("a").click(function(a){a.preventDefault(),b=$(this).attr("href"),g.tabHistory[g.tabHistory.length-1]!=b&&g.tabHistory.push(b),g.tabHistory.length>2&&(g.tabHistory=g.tabHistory.splice(g.tabHistory.length-2))}),a.find("span.glyphicon-remove").on("click",function(){var a=$(this).parent();d(a)}),e={items:[{text:'<div id="tabClose"><span class="glyphicon glyphicon-remove red"></span> '+g.msg.close+"</div>",onclick:function(){$(c).find("span.glyphicon-remove").trigger("click")}},{text:'<span style="margin-left:17px;"></span> '+g.msg.closeOthers,onclick:function(){$(c).parent().parent().find("a").not(c).find("span.glyphicon-remove").trigger("click")}},{text:'<span style="margin-left:17px;"></span> '+g.msg.closeAll,onclick:function(){$(c).parent().parent().find("a").find("span.glyphicon-remove").trigger("click")}},{divider:!0},{text:'<span style="margin-left:17px;"></span> '+g.msg.closeRight,onclick:function(){$(c).parent().nextAll().find("span.glyphicon-remove").trigger("click")}},{text:'<span style="margin-left:17px;"></span> '+g.msg.closeLeft,onclick:function(){$(c).parent().prevAll().find("span.glyphicon-remove").trigger("click")}},{divider:!0},{text:'<span class="glyphicon glyphicon-refresh green"></span> '+g.msg.reload,onclick:function(){g.refreshTab($(c).attr("href").substring(1))}}],before:function(a){c=a,0==$(a).find("span.glyphicon-remove").length?setTimeout(function(){$("#tabClose span").removeClass("red");var a=$("#tabClose").parent();a.parent().addClass("disabled"),a.css({color:"#C6C6C6",cursor:"default"})},0):setTimeout(function(){$("#tabClose sapn").addClass("red");var a=$("#tabClose").parent();a.parent().removeClass("disabled"),a.css({color:"#333333",cursor:"pointer"})},0)}},f=a.find("a"),f.has(".glyphicon-remove").contextify(e),f.has(":not(.glyphicon-remove)").contextify(e)},f=function(a,b,c){$.ajax({type:g.method,url:b,async:!0,data:c,beforeSend:function(){$(a).html(g.msg.loading)},error:function(b,c,d){$(a).html("Errorï¼š"+c),console.error(d)},complete:function(){},success:function(b){$(a).html(b)}})},g={tabId:null,tabObj:null,method:"get",tabHistory:[],removeTab:function(a,b){var c=g.tabObj;b?d(c.find('[href="#'+a+'"]')):c.find('[href="#'+a+'"] span.glyphicon-remove').trigger("click")},removeAllTab:function(a){var b=g.tabObj;b.find("span.glyphicon-remove").trigger("click"),a&&b.find("a").each(function(){d($(this))})},selectTab:function(a){return $("#"+a).length>0?(b="#"+a,g.tabObj.find('[href="#'+a+'"]').tab("show"),g.tabHistory[g.tabHistory.length-1]!="#"+a&&g.tabHistory.push("#"+a),!0):!1},refreshTab:function(a){for(var b=0;b<c.length;b++)c[b].id==a&&f("#"+a,c[b].url,c[b].data)},addTab:function(a,d,h,i){c.push({id:a,text:d,url:h,data:i});var j=g.tabObj;g.selectTab(a)||(j.append('<li><a data-toggle="tab" href="#'+a+'">'+d+' <span class="ace-icon glyphicon glyphicon-remove" aria-hidden="true"></span>'+"</a>"+"</li>"),tabConentObj=j.next(".tab-content"),tabConentObj.append('<div id="'+a+'" class="tab-pane"></div>'),f("#"+a,h,i),j.find('[href="#'+a+'"]').tab("show"),g.tabHistory[g.tabHistory.length-1]!="#"+a&&g.tabHistory.push("#"+a),g.tabHistory.length>2&&(g.tabHistory=g.tabHistory.splice(g.tabHistory.length-2)),b="#"+a,e(j))},init:function(c){var d,f;this.tabId=c,this.tabObj=$(c),d=this.tabObj,b=d.find("a:first").attr("href"),a&&(f=d.find("a:first"),f.length>0&&(f.tab("show"),b=f.attr("href"))),g.tabHistory.push(b),e(d)}};window.EasyBootstrapTabs=g}();